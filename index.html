<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secure Cookie Manager</title>

<style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    h2 { color: #333; }
    input, button { padding: 8px; margin: 5px; }
    #logBox {
        background: #000; color: #0f0; padding: 10px;
        height: 230px; overflow-y: auto; font-family: monospace;
        border: 2px solid #444;
    }
    button {
        cursor: pointer;
        background: #333;
        color: #fff;
        border: none;
        border-radius: 5px;
    }
    button:hover { background: #555; }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    td, th {
        border: 1px solid #444;
        padding: 8px;
        background: white;
    }
</style>
</head>
<body>

<h2>Secure Cookie Manager</h2>

<label>Cookie Name:</label>
<input id="cName" type="text"><br>

<label>Cookie Value:</label>
<input id="cValue" type="text"><br>

<label>Days To Live:</label>
<input id="cDays" type="number" value="1"><br>

<button onclick="setCookie()">Set Cookie (Unsafe)</button>
<button onclick="setSecureCookie()">Set Cookie (Secure)</button>
<button onclick="readCookie()">Read Cookie</button>
<button onclick="deleteCookie()">Delete Cookie</button>

<h3>Logs:</h3>
<div id="logBox"></div>

<h3>Cookie Dashboard:</h3>
<table id="cookieTable">
    <tr><th>Name</th><th>Value</th></tr>
</table>

<script>

// LOG SYSTEM
function log(msg, type="info") {
    let logBox = document.getElementById("logBox");
    let color = type === "warn" ? "yellow" :
                  type === "error" ? "red" : "lightgreen";

    logBox.innerHTML += `<span style="color:${color}">[${type.toUpperCase()}] ${msg}</span><br>`;
    logBox.scrollTop = logBox.scrollHeight;
}

// ENCRYPTION (Base64) – Simple Simulated Encryption
function encryptCookie(value) {
    try { return btoa(value); }
    catch { return null; }
}

function decryptCookie(value) {
    try { return atob(value); }
    catch { return value; }
}

// SET UNSAFE COOKIE
function setCookie() {
    let name = cName.value;
    let value = encryptCookie(cValue.value);
    let days = cDays.value;

    let maxAge = days * 86400;

    document.cookie = `${name}=${value}; max-age=${maxAge}; path=/`;

    log(`Cookie "${name}" stored (UNSAFE) with encryption.`, "warn");
    updateDashboard();
}

// SET SECURE COOKIE
function setSecureCookie() {
    let name = cName.value;
    let value = encryptCookie(cValue.value);
    let days = cDays.value;

    let maxAge = days * 86400;

    document.cookie = `${name}=${value}; max-age=${maxAge}; path=/; Secure; SameSite=Strict`;

    log(`Secure cookie "${name}" stored encrypted.`, "info");
    log(`HttpOnly cannot be set from JavaScript.`, "warn");
    updateDashboard();
}

// READ COOKIE
function getCookie(name) {
    let cookies = document.cookie.split(";");

    for (let c of cookies) {
        let [key, value] = c.split("=");
        if (key.trim() === name) return decryptCookie(value);
    }
    return null;
}

function readCookie() {
    let name = cName.value;
    let value = getCookie(name);

    if (value) log(`Cookie "${name}" value: ${value}`, "info");
    else log(`Cookie "${name}" not found`, "error");
}

// DELETE COOKIE
function deleteCookie() {
    let name = cName.value;

    document.cookie = `${name}=; max-age=0; path=/`;

    log(`Cookie "${name}" deleted.`, "error");
    updateDashboard();
}

// COOKIE DASHBOARD (Table Update)
function updateDashboard() {
    let table = document.getElementById("cookieTable");
    table.innerHTML = "<tr><th>Name</th><th>Value</th></tr>";

    let cookies = document.cookie.split(";");

    cookies.forEach(c => {
        let [key, value] = c.split("=");
        if (!key.trim()) return;

        value = decryptCookie(value);

        table.innerHTML += `
            <tr>
                <td>${key.trim()}</td>
                <td>${value}</td>
            </tr>
        `;
    });
}

// update dashboard once on load
updateDashboard();

// AUTO SECURITY SCANNER
function scanCookiesForSecurity() {
    let cookies = document.cookie.split(";");

    log("Scanning cookies...", "info");

    cookies.forEach(c => {
        let name = c.split("=")[0].trim();

        if (!c.includes("Secure"))
            log(`⚠ "${name}" missing Secure`, "warn");

        if (!c.includes("SameSite"))
            log(`⚠ "${name}" missing SameSite`, "warn");

        log(`Scan complete for "${name}".`, "info");
    });
}

setInterval(scanCookiesForSecurity, 5000);
    
// Rename v2.html to index.html

</script>

</body>
</html>

